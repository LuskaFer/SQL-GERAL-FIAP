
/*SCRIPTS DDL E DML DOS PROJETOS SIP E SPV EM FORMA DE COMENTÁRIO PARA O CASO 
DE NÃO POSSUIR AS TABELAS E/OU SEUS CONTEÚDOS.

CASO NÃO POSSUA AS TABELAS FAVOR EXECUTÁ-LOS ANTES DA EXECUÇÃO DAS RESPOSTAS.
*/



/*
DROP TABLE T_SPV_PRODUTO CASCADE CONSTRAINTS;
DROP TABLE T_SPV_UNID_COMERCIAL CASCADE CONSTRAINTS;
DROP TABLE T_SPV_CLASSIF_FISCAL CASCADE CONSTRAINTS;
DROP TABLE T_SPV_CLIENTE CASCADE CONSTRAINTS;
DROP TABLE T_SPV_NOTA_FISCAL CASCADE CONSTRAINTS;
DROP TABLE T_SPV_ITEM_NF CASCADE CONSTRAINTS;

DROP TABLE T_SIP_DEPARTAMENTO CASCADE CONSTRAINTS;
DROP TABLE T_SIP_DEPENDENTE CASCADE CONSTRAINTS;
DROP TABLE T_SIP_FUNCIONARIO CASCADE CONSTRAINTS;
DROP TABLE T_SIP_IMPLANTACAO CASCADE CONSTRAINTS;
DROP TABLE T_SIP_PROJETO CASCADE CONSTRAINTS;
*/

/*
DELETE FROM T_SPV_PRODUTO;
DELETE FROM T_SPV_UNID_COMERCIAL;
DELETE FROM T_SPV_CLASSIF_FISCAL;
DELETE FROM T_SPV_CLIENTE;
DELETE FROM T_SPV_NOTA_FISCAL;
DELETE FROM T_SPV_ITEM_NF;
*/

/*
DELETE FROM T_SIP_IMPLANTACAO;
DELETE FROM T_SIP_PROJETO;
DELETE FROM T_SIP_DEPENDENTE;
DELETE FROM T_SIP_FUNCIONARIO;
DELETE FROM T_SIP_DEPARTAMENTO;
*/

-- DDL SPV

/*CREATE TABLE T_SPV_CLASSIF_FISCAL
  (
    nr_cfop             NUMBER(4)      NOT NULL ,
    ds_tipo_operacao    NUMBER(1)      NOT NULL ,
    nm_nat_operacao     VARCHAR2(50)   NOT NULL ,
    ds_nat_operacao     VARCHAR2(600)  NOT NULL
  );
  
ALTER TABLE T_SPV_CLASSIF_FISCAL 
    ADD CONSTRAINT T_SPV_CLASSIF_FISCAL_OP 
    CHECK (DS_TIPO_OPERACAO IN (1,2));

ALTER TABLE T_SPV_CLASSIF_FISCAL
    ADD CONSTRAINT PK_CLASSIF_FISCAL 
    PRIMARY KEY (nr_cfop);
    
ALTER TABLE T_SPV_CLASSIF_FISCAL 
    ADD CONSTRAINT UN_SPV_CLASSIF_FISCAL_NATOP 
    UNIQUE (nm_nat_operacao);


CREATE TABLE T_SPV_CLIENTE
  (
    cd_cliente      NUMBER(5)       NOT NULL,
    nm_cliente      VARCHAR2(50)    NOT NULL,
    dt_nascimento   DATE            NULL,
    ds_genero       CHAR(2)         NOT NULL,
    ds_endereco     VARCHAR2(100)   NOT NULL,
    nr_ddd_fone     NUMBER(3)       NULL,
    nr_telefone     NUMBER(9)       NULL,
    ds_email        VARCHAR2(40)    NULL,
    nr_cpf          NUMBER(9)       NOT NULL,
    nr_cpf_dig      NUMBER(2)       NOT NULL,
    nr_rg           NUMBER(8)       NOT NULL,
    nr_rg_dig       CHAR(1)         NOT NULL
  );
  
ALTER TABLE T_SPV_CLIENTE 
    ADD CONSTRAINT CK_SPV_CLIENTE_GENERO 
    CHECK (UPPER(DS_GENERO) = 'H' OR UPPER(DS_GENERO) = 'M' OR UPPER(DS_GENERO) = 'NB');
    
ALTER TABLE T_SPV_CLIENTE 
    ADD CONSTRAINT PK_SPV_CLIENTE 
    PRIMARY KEY (cd_cliente);


CREATE TABLE T_SPV_ITEM_NF
  (
    nr_nota_fiscal      NUMBER(5)       NOT NULL ,
    cd_produto          NUMBER(5)       NOT NULL ,
    qt_vendida          NUMBER(4)       NOT NULL ,
    vl_preco_unit_venda NUMBER(6,2)     NOT NULL ,
    vl_preco_total_item NUMBER(8,2)     NOT NULL
  ) ;
  
ALTER TABLE T_SPV_ITEM_NF 
    ADD CONSTRAINT CK_SPV_ITEM_NF_QT_VENDIDA 
    CHECK (qt_vendida > 0);
    
ALTER TABLE T_SPV_ITEM_NF 
    ADD CONSTRAINT CK_SPV_ITEM_NF_PRECO_UNIT 
    CHECK (vl_preco_unit_venda > 0.00);
    
ALTER TABLE T_SPV_ITEM_NF 
    ADD CONSTRAINT PK_SPV_ITEM_NF 
    PRIMARY KEY (nr_nota_fiscal, cd_produto);


CREATE TABLE T_SPV_NOTA_FISCAL
  (
    nr_nota_fiscal NUMBER(5)       NOT NULL,
    cd_cliente     NUMBER(5)       NOT NULL,
    nr_cfop        NUMBER(4)       NOT NULL,
    dt_emissao     DATE            NOT NULL,
    dt_saida       DATE            NOT NULL,
    vl_total_nf    NUMBER(9,2)     NOT NULL,
    vl_desconto    NUMBER(3,1)     NOT NULL
  );
  
ALTER TABLE T_SPV_NOTA_FISCAL 
    ADD CONSTRAINT CK_SPV_NOTA_FISCAL_DT 
    CHECK (dt_saida >= dt_emissao);
    
ALTER TABLE T_SPV_NOTA_FISCAL 
    ADD CONSTRAINT CK_SPV_NOTA_FISCAL_DESCONTO 
    CHECK (VL_DESCONTO >= 0 AND VL_DESCONTO <= 25);
    
ALTER TABLE T_SPV_NOTA_FISCAL 
    ADD CONSTRAINT PK_SPV_NOTA_FISCAL 
    PRIMARY KEY (nr_nota_fiscal);


CREATE TABLE T_SPV_PRODUTO
  (
    cd_produto          NUMBER(5)      NOT NULL,
    cd_unid_comercial   NUMBER(3)      NOT NULL,
    ds_produto          VARCHAR2(30)   NOT NULL,
    ds_produto_completa VARCHAR2(80)   NOT NULL,
    qt_estoque          NUMBER(4)      NOT NULL,
    vl_preco_unitario   NUMBER(6,2)    NOT NULL
  ) ;
  
ALTER TABLE T_SPV_PRODUTO 
    ADD CONSTRAINT CK_SPV_PRODUTO_PREUNI 
    CHECK (VL_PRECO_UNITARIO > 0);
    
ALTER TABLE T_SPV_PRODUTO 
    ADD CONSTRAINT PK_SPV_PRODUTO 
    PRIMARY KEY ( cd_produto );
    
ALTER TABLE T_SPV_PRODUTO 
    ADD CONSTRAINT UN_SPV_PRODUTO_DESC 
    UNIQUE ( ds_produto );


CREATE TABLE T_SPV_UNID_COMERCIAL
  (
    cd_unid_comercial       NUMBER(3)         NOT NULL,
    sg_unid_comercial       VARCHAR2(10)      NOT NULL,
    ds_unid_comercial       VARCHAR2(30)      NOT NULL
  );
  
ALTER TABLE T_SPV_UNID_COMERCIAL 
    ADD CONSTRAINT PK_SPV_UNID_COMERCIAL 
    PRIMARY KEY (cd_unid_comercial);
    
ALTER TABLE T_SPV_UNID_COMERCIAL 
    ADD CONSTRAINT UN_SPV_UNID_COMERCIAL_DESC 
    UNIQUE (ds_unid_comercial);


ALTER TABLE T_SPV_ITEM_NF 
    ADD CONSTRAINT FK_SPV_ITEM_NF_NOTA_FISCAL 
    FOREIGN KEY (nr_nota_fiscal) 
    REFERENCES T_SPV_NOTA_FISCAL (nr_nota_fiscal)
    ON DELETE CASCADE;

ALTER TABLE T_SPV_ITEM_NF 
    ADD CONSTRAINT FK_SPV_ITEM_NF_PRODUTO 
    FOREIGN KEY (cd_produto) 
    REFERENCES T_SPV_PRODUTO (cd_produto)
    ON DELETE CASCADE;

ALTER TABLE T_SPV_NOTA_FISCAL 
    ADD CONSTRAINT FK_SPV_NF_CLASSIF_FISCAL 
    FOREIGN KEY (nr_cfop) 
    REFERENCES T_SPV_CLASSIF_FISCAL (nr_cfop)
    ON DELETE CASCADE;

ALTER TABLE T_SPV_NOTA_FISCAL 
    ADD CONSTRAINT FK_SPV_NF_CLIENTE 
    FOREIGN KEY (cd_cliente) 
    REFERENCES T_SPV_CLIENTE (cd_cliente)
    ON DELETE CASCADE;

ALTER TABLE T_SPV_PRODUTO 
    ADD CONSTRAINT FK_SPV_UNID_COMERCIAL 
    FOREIGN KEY (cd_unid_comercial) 
    REFERENCES T_SPV_UNID_COMERCIAL (cd_unid_comercial) 
    ON DELETE CASCADE;
*/

-- DML SPV
/*
INSERT INTO T_SPV_UNID_COMERCIAL (CD_UNID_COMERCIAL, SG_UNID_COMERCIAL, DS_UNID_COMERCIAL)   -- COMANDO PARA INSERÇÃO, COM NOME DA TABELA E DAS COLUNAS
    VALUES (1, 'CX', 'CAIXA');
    
INSERT INTO T_SPV_UNID_COMERCIAL
    VALUES (2, 'PACOTE', 'PACOTE');

INSERT INTO T_SPV_UNID_COMERCIAL
    VALUES (3, 'PC', 'PEÇA');
    
INSERT INTO T_SPV_UNID_COMERCIAL
    VALUES (4, 'M', 'METRO');
    
INSERT INTO T_SPV_UNID_COMERCIAL
    VALUES (5, 'KG', 'QUILOGRAMA');
    
    
INSERT INTO T_SPV_CLASSIF_FISCAL (NR_CFOP, DS_TIPO_OPERACAO, NM_NAT_OPERACAO, DS_NAT_OPERACAO)
    VALUES (1101, 1, 'COMPRA INDUSTRIALIZAÇÃO', 'COMPRA DE MERCADORIAS PARA PROCESSOS DE INDUSTRIALIZAÇÃO');
    
INSERT INTO T_SPV_CLASSIF_FISCAL
    VALUES (1102, 1, 'COMPRA COMERCIALIZAÇÃO', 'COMPRA DE MERCADORIAS PARA SEREM COMERCIALIZADAS');

INSERT INTO T_SPV_CLASSIF_FISCAL
    VALUES (5101, 2, 'VENDA', 'VENDA DE MERCADORIAS COMERCIALIZADAS');

INSERT INTO T_SPV_CLASSIF_FISCAL
    VALUES (5102, 2, 'BRINDE', 'MERCADORIAS OFERECIDAS NAS COMERCIALIZAÇÕES SEM CUSTO');
    
    
INSERT INTO T_SPV_CLIENTE (CD_CLIENTE, NM_CLIENTE, DT_NASCIMENTO, DS_GENERO, DS_ENDERECO, NR_DDD_FONE, NR_TELEFONE, DS_EMAIL, NR_CPF, NR_CPF_DIG, NR_RG, NR_RG_DIG)
    VALUES (1, 
        'MARIA DAS DORES', 
        TO_DATE('21/04/1987', 'DD/MM/YYYY'),
        'M', 
        'RUA AGUAPEI, 25', 
        11, 
        945451212,
        'MARIAJOSE@MARIAJOSE.COM.BR',
        12345678, 
        9,
        1234567, 
        8);
        
INSERT INTO T_SPV_CLIENTE
    VALUES (2,
            'ANA MARIA',
            TO_DATE('10/02/1986', 'DD/MM/YYYY'),
            'M',
            'RUA BELA VISTA, 30',
            11,
            94541213,
            'ANAMARIA@ANAMARIA.COM.BR',
            23456789,
            0,
            2345678,
            9);
        
INSERT INTO T_SPV_CLIENTE
    VALUES (3,
            'JOÃO DA SILVA',
            TO_DATE('08/09/1991', 'DD/MM/YYYY'),
            'H',
            'AVENIDA PAULISTA, 1009',
            11,
            945412141,
            'JOAOSILVA@JOAOSILVA.COM.BR',
            34567890,
            1,
            3456789,
            0);
            
INSERT INTO T_SPV_CLIENTE
    VALUES (4,
            'JOAQUIM XAVIER',
            TO_DATE('21/04/1988', 'DD/MM/YYYY'),
            'H',
            'AVENIDA SÃO JOÃO, 34',
            11,
            945412151,
            'JOAQUIMXAVIER@JOAQUIMXAVIER.COM.BR',
            45678901,
            2,
            4567890,
            1);


UPDATE T_SPV_CLIENTE
    SET NR_TELEFONE = 945451213
    WHERE CD_CLIENTE = 2;   


INSERT INTO T_SPV_PRODUTO (CD_PRODUTO, CD_UNID_COMERCIAL, DS_PRODUTO, DS_PRODUTO_COMPLETA, QT_ESTOQUE, VL_PRECO_UNITARIO)
    VALUES (1, 1, 'NOTEBOOK SENSACIONAL', 'NOTEBOOK XPTO SUPER ESPECIAL', 3, 1980.56);
    
INSERT INTO T_SPV_PRODUTO 
    VALUES (2, 1, 'IMPRESSORA X3', 'IMPRESSORA MULTIFUNCIONAL HP', 5, 432.89);
    
INSERT INTO T_SPV_PRODUTO 
    VALUES (3, 1, 'PEN DRIVE - 16GB', 'PEN DRIVE 16GB KINGSTON', 10, 60);
    
INSERT INTO T_SPV_PRODUTO 
    VALUES (4, 1, 'PEN DRIVE - 32 GB', 'PEN DRIVE 32GB KINGSTON', 10, 108);
    
INSERT INTO T_SPV_PRODUTO 
    VALUES (5, 1, 'HD EXTERNO - 500GB', 'HD EXTERNO SAMSUMG - 500GB', 10, 305);
    
INSERT INTO T_SPV_PRODUTO 
    VALUES (6, 1, 'HD EXTERNO - 1TB', 'HD EXTERNO SAMSUNG - 1TB', 10, 870);
--

INSERT INTO T_SPV_NOTA_FISCAL (NR_NOTA_FISCAL, CD_CLIENTE, NR_CFOP, DT_EMISSAO, DT_SAIDA, VL_TOTAL_NF, VL_DESCONTO)
    VALUES (1234, 1, 1102, TO_DATE('09/08/2019', 'DD/MM/YYYY'), TO_DATE('09/08/2019', 'DD/MM/YYYY'), 870, 2.5);
    
INSERT INTO T_SPV_NOTA_FISCAL
    VALUES (1235, 1, 1102, TO_DATE('10/08/2019', 'DD/MM/YYYY'), TO_DATE('11/08/2019', 'DD/MM/YYYY'), 2168.67, 2);

INSERT INTO T_SPV_NOTA_FISCAL
    VALUES (1236, 2, 5101, TO_DATE('15/08/2019', 'DD/MM/YYYY'), TO_DATE('15/08/2019', 'DD/MM/YYYY'), 60, 0);


INSERT INTO T_SPV_ITEM_NF (NR_NOTA_FISCAL, CD_PRODUTO, QT_VENDIDA, VL_PRECO_UNIT_VENDA, VL_PRECO_TOTAL_ITEM)
    VALUES (1234, 6, 1, 870, 870);
    
INSERT INTO T_SPV_ITEM_NF 
    VALUES (1235, 6, 1, 870, 870);
    
INSERT INTO T_SPV_ITEM_NF 
    VALUES (1235, 2, 3, 432.89, 1298.67);
    
INSERT INTO T_SPV_ITEM_NF
    VALUES (1236, 3, 1, 60, 60);
*/

/*
SELECT * FROM T_SPV_UNID_COMERCIAL;
SELECT * FROM T_SPV_CLASSIF_FISCAL;
SELECT * FROM T_SPV_CLIENTE;
SELECT * FROM T_SPV_PRODUTO;
SELECT * FROM T_SPV_NOTA_FISCAL;
SELECT * FROM T_SPV_ITEM_NF;
*/


-- DDL SIP

/*
CREATE TABLE T_SIP_DEPARTAMENTO
(
    CD_DEPTO        NUMBER(3)       NOT NULL ,
    NM_DEPTO        VARCHAR2(30)    NOT NULL ,
    SG_DEPTO        CHAR(3)         NOT NULL 
);
-- ADICIONAR A CONSTRAINT CHAVE PRIMARIA
   ALTER TABLE T_SIP_DEPARTAMENTO  
ADD CONSTRAINT PK_SIP_DEPARTAMENTO 
   PRIMARY KEY (CD_DEPTO);         

-- ADICIONAR A CONSTRAINT UNIQUE
   ALTER TABLE T_SIP_DEPARTAMENTO  
ADD CONSTRAINT UN_SIP_DEPTO_NOME   
        UNIQUE (NM_DEPTO);         
        

-- CRIAR A TABELA FUNCIONARIO
CREATE TABLE T_SIP_FUNCIONARIO
(
    NR_MATRICULA        NUMBER(5)       NOT NULL ,
    CD_DEPTO            NUMBER(3)       NOT NULL ,
    NM_FUNCIONARIO      VARCHAR2(50)    NOT NULL ,
    DT_NASCIMENTO       DATE            NOT NULL ,
    DT_ADMISSAO         DATE            NOT NULL ,
    DS_ENDERECO         VARCHAR2(100)   NOT NULL ,
    VL_SALARIO          NUMBER(7,2)     NOT NULL
);

-- ADICIONAR A CONSTRAINT CHAVE PRIMARIA
   ALTER TABLE T_SIP_FUNCIONARIO
ADD CONSTRAINT PK_SIP_FUNCIONARIO
   PRIMARY KEY (NR_MATRICULA);

-- ADICIONAR A CONSTRAINT CHECK
   ALTER TABLE T_SIP_FUNCIONARIO
ADD CONSTRAINT CK_SIP_FUNC_SALARIO
         CHECK (VL_SALARIO >= 1045); 
         

-- CRIAR A TABELA DEPENDENTE
CREATE TABLE T_SIP_DEPENDENTE
(
    NR_MATRICULA        NUMBER(5)       NOT NULL ,
    CD_DEPENDENTE       NUMBER(2)       NOT NULL ,
    NM_DEPENDENTE       VARCHAR2(50)    NOT NULL ,
    DT_NASCIMENTO       DATE            NOT NULL
);

-- ADICIONAR A CONSTRAINT CHAVE PRIMARIA (CHAVE PRIMARIA COMPOSTA)
   ALTER TABLE T_SIP_DEPENDENTE
ADD CONSTRAINT PK_SIP_DEPENDENTE
   PRIMARY KEY (NR_MATRICULA, CD_DEPENDENTE);


-- CRIAR A TABELA PROJETO
CREATE TABLE T_SIP_PROJETO
(
    CD_PROJETO          NUMBER(5)       NOT NULL ,
    NM_PROJETO          VARCHAR2(40)    NOT NULL ,
    DT_INICIO           DATE            NOT NULL ,
    DT_TERMINO          DATE                NULL    
);

-- ADICIONAR A CONSTRAINT CHAVE PRIMARIA
   ALTER TABLE T_SIP_PROJETO
ADD CONSTRAINT PK_SIP_PROJETO
   PRIMARY KEY (CD_PROJETO);
   
-- ADICIONAR A CONSTRAINT UNIQUE
   ALTER TABLE T_SIP_PROJETO
ADD CONSTRAINT UN_SIP_PROJETO_NOME
        UNIQUE (NM_PROJETO);
        
-- ADICIONAR A CONSTRAINT CHECK
   ALTER TABLE T_SIP_PROJETO
ADD CONSTRAINT CK_SIP_PROJETO_DATA
         CHECK (DT_TERMINO > DT_INICIO);

-- CRIAR A TABELA IMPLANTACAO
CREATE TABLE T_SIP_IMPLANTACAO
(
    CD_PROJETO          NUMBER(5)       NOT NULL ,
    CD_IMPLANTACAO      NUMBER(3)       NOT NULL ,
    NR_MATRICULA        NUMBER(5)       NOT NULL ,
    DT_ENTRADA          DATE            NOT NULL ,
    DT_SAIDA            DATE                NULL
);

-- ADICIONAR A CONSTRAINT CHAVE PRIMARIA
   ALTER TABLE T_SIP_IMPLANTACAO
ADD CONSTRAINT PK_SIP_IMPLANTACAO
   PRIMARY KEY (CD_PROJETO, CD_IMPLANTACAO); 
   
-- ADICIONAR A CONSTRAINT CHECK
   ALTER TABLE T_SIP_IMPLANTACAO
ADD CONSTRAINT CK_SIP_IMPLANT_DATA
         CHECK (DT_SAIDA > DT_ENTRADA);

-- CRIAR (ADICIONAR) O RELACIONAMENTO ENTRE FUNCIONARIO (DESTINO) E DEPARTAMENTO (ORIGEM)
   ALTER TABLE T_SIP_FUNCIONARIO  
ADD CONSTRAINT FK_SIP_FUNC_DEPTO  
   FOREIGN KEY (CD_DEPTO)         
    REFERENCES  T_SIP_DEPARTAMENTO (CD_DEPTO);   
    
-- CRIAR O RELACIONAMENTO ENTRE DEPENDENTE (DESTINO) E FUNCIONARIO (ORIGEM)
   ALTER TABLE T_SIP_DEPENDENTE
ADD CONSTRAINT FK_SIP_DEPENDENTE_FUNC
   FOREIGN KEY (NR_MATRICULA)
    REFERENCES T_SIP_FUNCIONARIO (NR_MATRICULA);   

-- CRIAR O RELACIONAMENTO ENTRE IMPLANTACAO (DESTINO) E PROJETO (ORIGEM)
   ALTER TABLE T_SIP_IMPLANTACAO
ADD CONSTRAINT FK_SIP_IMPLANT_PROJETO
   FOREIGN KEY (CD_PROJETO)
    REFERENCES T_SIP_PROJETO (CD_PROJETO);  

-- CRIAR O RELACIONAMENTO ENTRE IMPLANTACAO (DESTINO) E FUNCIONARIO (ORIGEM)
   ALTER TABLE T_SIP_IMPLANTACAO
ADD CONSTRAINT FK_SIP_IMPLANT_FUNC
   FOREIGN KEY (NR_MATRICULA)
    REFERENCES T_SIP_FUNCIONARIO (NR_MATRICULA);
*/


-- DML SIP
/*
-- POPULAR A TABELA DEPTO
INSERT INTO T_SIP_DEPARTAMENTO VALUES (1, 'FINANCEIRO', 'FIN');
INSERT INTO T_SIP_DEPARTAMENTO VALUES (2, 'TECNOLOGIA DA INFORMAÇÃO','TIN');
INSERT INTO T_SIP_DEPARTAMENTO VALUES (3, 'CONTAS A PAGAR','CPG');
INSERT INTO T_SIP_DEPARTAMENTO VALUES (4, 'FATURAMENTO','FAT');
INSERT INTO T_SIP_DEPARTAMENTO VALUES (5, 'RECURSOS HUMANOS', 'RHU');

-- POPULAR A TABELA FUNCIONARIO COM 3 FUNCIONARIOS PARA CADA DEPTO
-- DEPTO = 1
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12345, 1, 'JOAO DA SILVA', TO_DATE('10/05/1985','DD/MM/YYYY'), 
     TO_DATE('15/09/2012','DD/MM/YYYY'),'RUA X, 49', 5684.66);

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12346, 1, 'MANUEL DA SILVA', TO_DATE('05/10/1998','DD/MM/YYYY'), 
     TO_DATE('10/11/2015','DD/MM/YYYY'),'RUA X, 31', 3542.11);

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12347, 1, 'JANDIRA DA SILVA', TO_DATE('10/12/2000','DD/MM/YYYY'), 
     TO_DATE('15/09/2018','DD/MM/YYYY'),'RUA X, 25', 1875.96);
     
-- DEPTO = 2
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12348, 2, 'KATIA REGINA SOUZA', TO_DATE('15/01/1995','DD/MM/YYYY'), 
     TO_DATE('03/10/2015','DD/MM/YYYY'),'RUA Y, 49', 3894.63);

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12349, 2, 'MARIA DAS DORES SOUZA', TO_DATE('18/08/1983','DD/MM/YYYY'), 
    TO_DATE('23/10/2017','DD/MM/YYYY'),'RUA Y, 35', 1542.55);

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12350, 2, 'ALFREDO DE SOUZA', TO_DATE('04/05/1999','DD/MM/YYYY'), 
    TO_DATE('05/06/2014','DD/MM/YYYY'),'RUA Y, 27', 5874.52);
    
-- DEPTO = 3    
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12351, 3, 'GISELE DE JESUS', TO_DATE('15/04/1999','DD/MM/YYYY'), 
    TO_DATE('20/03/2017','DD/MM/YYYY'),'RUA Z, 49', 1060.66);    

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12352, 3, 'RAFAEL DE JESUS', TO_DATE('10/08/1998','DD/MM/YYYY'), 
    TO_DATE('10/08/2012','DD/MM/YYYY'),'RUA Z, 55', 2563.44);    

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12353, 3, 'ROSANA DE JESUS', TO_DATE('14/03/1987','DD/MM/YYYY'), 
    TO_DATE('15/08/2019','DD/MM/YYYY'),'RUA Z, 79', 4879.55);  
    
-- DEPTO = 4
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12354, 4, 'JOSEFINA DE ALMEIDA', TO_DATE('16/10/1997','DD/MM/YYYY'), 
    TO_DATE('25/03/2013','DD/MM/YYYY'),'RUA Y, 33', 4561.88);    

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12355, 4, 'LUCIANA DE ALMEIDA', TO_DATE('10/02/1984','DD/MM/YYYY'), 
    TO_DATE('28/09/2011','DD/MM/YYYY'),'RUA Y, 44', 2345.52);    

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12356, 4, 'THIAGO DE ALMEIDA', TO_DATE('10/03/1998','DD/MM/YYYY'), 
    TO_DATE('24/10/2018','DD/MM/YYYY'),'RUA Y, 55', 1254.22);    
    
-- DEPTO = 5
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12357, 5, 'LARISSSA DE CAMARGO', TO_DATE('14/02/1997','DD/MM/YYYY'), 
    TO_DATE('04/08/2015','DD/MM/YYYY'),'RUA V, 22', 1245.55);    
    
INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12358, 5, 'ANTONIO DE CAMARGO', TO_DATE('25/01/1985','DD/MM/YYYY'), 
    TO_DATE('12/08/2016','DD/MM/YYYY'),'RUA V, 44', 2451.33);    

INSERT INTO T_SIP_FUNCIONARIO VALUES
    (12359, 5, 'JOSE DE CAMARGO', TO_DATE('23/10/1998','DD/MM/YYYY'), 
    TO_DATE('20/04/2017','DD/MM/YYYY'),'RUA V, 88', 6541.22);    


-- POPULAR A TABELA DEPENDENTE
-- FUNCIONARIO = 12345
INSERT INTO T_SIP_DEPENDENTE VALUES
(12345, 1, 'JOANINHA', TO_DATE('12/10/2010','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12345, 2, 'JULINHA', TO_DATE('15/10/2012','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12345, 3, 'TONINHO', TO_DATE('22/10/2014','DD/MM/YYYY'));

-- FUNCIONARIO = 12356
INSERT INTO T_SIP_DEPENDENTE VALUES
(12356, 1,'JUNINHO', TO_DATE('02/10/2011','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12356, 2, 'ZEZINHO', TO_DATE('15/10/2013','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12356, 3, 'MARCELINHO', TO_DATE('17/10/2015','DD/MM/YYYY'));

-- FUNCIONARIO = 12359
INSERT INTO T_SIP_DEPENDENTE VALUES
(12359, 1,'MARIAZINHA', TO_DATE('11/06/2014','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12359, 2,'LUIZINHA', TO_DATE('21/06/2016','DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE VALUES
(12359, 3,'CARMINHA', TO_DATE('18/06/2018','DD/MM/YYYY'));

-- POPULAR A TABELA PROJETO 
INSERT INTO T_SIP_PROJETO VALUES 
(10001, 'PROJETO 1', TO_DATE('11/10/2016','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO VALUES 
(10002, 'PROJETO 2', TO_DATE('25/10/2013','DD/MM/YYYY'), TO_DATE('15/04/2015','DD/MM/YYYY'));
INSERT INTO T_SIP_PROJETO VALUES 
(10003, 'PROJETO 3', TO_DATE('28/04/2012','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO VALUES 
(10004, 'PROJETO 4', TO_DATE('25/03/2017','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO VALUES 
(10005, 'PROJETO 5', TO_DATE('28/09/2014','DD/MM/YYYY'), TO_DATE('15/09/2018','DD/MM/YYYY'));

-- POPULAR A TABELA IMPLANTACAO. ESCOLHER 3 PROJETOS, E PARA CADA PROJETO, 3 
-- FUNCIONARIOS TRABALHANDO NAS IMPLANTACOES
-- CONSIDERANDO: DATA INICIO E TERMINO DOS PROJETOS, CONSIDERANDO A DATA DE ADMISSAO
-- DE CADA FUNCIONARIO PARTICIPANTE
-- PROJETO 1
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10001, 1, 12345, TO_DATE('11/10/2016','DD/MM/YYYY'), TO_DATE('15/09/2017','DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10001, 2, 12346, TO_DATE('11/10/2016','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10001, 3, 12348, TO_DATE('11/10/2016','DD/MM/YYYY'), TO_DATE('25/06/2018','DD/MM/YYYY'));
-- PROJETO 2
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10002, 1, 12345, TO_DATE('25/10/2013','DD/MM/YYYY'), TO_DATE('15/04/2014','DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10002, 2, 12352, TO_DATE('25/10/2013','DD/MM/YYYY'), TO_DATE('25/07/2014','DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10002, 3, 12355, TO_DATE('25/10/2013','DD/MM/YYYY'), TO_DATE('15/04/2015','DD/MM/YYYY'));
-- PROJETO 3
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10003, 1, 12354, TO_DATE('28/04/2013','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10003, 2, 12355, TO_DATE('28/04/2013','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10003, 3, 12345, TO_DATE('28/04/2013','DD/MM/YYYY'), NULL);
-- PROJETO 4
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10004, 1, 12357, TO_DATE('25/03/2017','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10004, 2, 12358, TO_DATE('25/03/2017','DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10004, 3, 12354, TO_DATE('25/03/2017','DD/MM/YYYY'), TO_DATE('15/08/2018','DD/MM/YYYY'));
-- PROJETO 5
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10005, 1, 12345, TO_DATE('28/09/2014','DD/MM/YYYY'), TO_DATE('15/09/2018','DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10005, 2, 12350, TO_DATE('28/09/2014','DD/MM/YYYY'), TO_DATE('15/09/2018','DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO VALUES 
(10005, 3, 12354, TO_DATE('28/09/2014','DD/MM/YYYY'), TO_DATE('15/09/2018','DD/MM/YYYY'));
*/

/*-- CONSULTAR TABELAS
SELECT * FROM T_SIP_DEPARTAMENTO;
SELECT * FROM T_SIP_FUNCIONARIO;
SELECT * FROM T_SIP_DEPENDENTE;
SELECT * FROM T_SIP_PROJETO;
SELECT * FROM T_SIP_IMPLANTACAO;
*/


--RESPOSTAS
/*1*/
UPDATE T_SPV_PRODUTO       
   SET QT_ESTOQUE = 13 
   WHERE CD_PRODUTO = 1;

UPDATE T_SPV_PRODUTO       
   SET QT_ESTOQUE = 15 
   WHERE CD_PRODUTO = 2;


/*2*/
DELETE FROM T_SPV_NOTA_FISCAL 
      WHERE NR_NOTA_FISCAL = 1236;      
                   
/*NÃO HOUVE PROBLEMA DURANTE A DELEÇÃO, POIS FOI UTILIZADO O WHERE, CASO NÃO TIVESSE UTILIZADO TODAS AS LINHAS DA TABELA TERIAM SIDO APAGADAS*/                               


/*3*/
DELETE FROM T_SPV_ITEM_NF 
ROLLBACK
  
/*SIM FOI POSSÍVEL DESFAZER A EXCLUSÃO. 
CONSIDERANDO QUE O COMMIT NÃO TINHA SIDO FEITO APÓS O DELETE OS DADOS DELETADOS DA TABELA ITEM_NF FORAM RECUPERADOS ATRAVÉS DO COMANDO ROLLBACK SEGUIDO DO COMMIT.
*/


/*4*/
SELECT CD_IMPLANTACAO, CD_PROJETO, NR_MATRICULA, DT_ENTRADA AS "INÍCIO EM:", DT_SAIDA AS "CONCLUSÃO:" 
  FROM T_SIP_IMPLANTACAO  
  WHERE DT_SAIDA IS NOT NULL      
  ORDER BY CD_PROJETO ASC, NR_MATRICULA ASC, DT_SAIDA DESC;

/*5*/

SELECT P.CD_PROJETO, 
 P.NM_PROJETO "PROJETO", 
 P.DT_INICIO "INÍCIO", 
 I.CD_IMPLANTACAO "NR. IMPLANT", 
 F.NM_FUNCIONARIO "NOME", 
 I.DT_ENTRADA "ENTRADA", 
 I.DT_SAIDA "SAIDA"
    FROM T_SIP_PROJETO P INNER JOIN T_SIP_IMPLANTACAO I 
        ON (P.CD_PROJETO = I.CD_PROJETO)
    INNER JOIN T_SIP_FUNCIONARIO F on (F.NR_MATRICULA = I.NR_MATRICULA)
    WHERE I.DT_SAIDA IS NULL
    ORDER BY P.NM_PROJETO, F.NM_FUNCIONARIO;
    
COMMIT;


